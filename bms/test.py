import time
import serial
ask_etl = b'\xAA\x09\x04\x22\x00\x23\x00\xF3\x1B'
#ask_etl = bytes([0xAA, 0x09, 0x04, 0x22, 0x00, 0x23, 0x00, 0xF3, 0x1B])
BMS = serial.Serial(port='/dev/ttyAMA0',baudrate=115200,bytesize=serial.EIGHTBITS,parity=serial.PARITY_NONE,stopbits=serial.STOPBITS_ONE, timeout=1,xonxoff=0,rtscts=0,dsrdtr=0)

while 1:
    BMS.reset_input_buffer()
    BMS.reset_output_buffer()
    msg = b''
    BMS.write(ask_etl)
    BMS.flush()
    BMS.write(ask_etl)
    #BMS.flush()
    msg = BMS.read(30)
    print(msg)
    time.sleep(1)

'''
expected b'\xaa\x09\x08\x22\x00\DATA\DATA\x23\x00\DADA\DATA\CRC\CRC'

b'\xaa\t\x08"\x00`/#\x00\xf1\x00\x83b\xaa\t\x08"\x00`/#\x00\xf1\x00\x83b'
b'\xaa\t\x08"\x00]/#\x00\xf1\x00\x87\x8f\xaa\t\x08"\x00]/#\x00\xf1\x00\x87\x8f'
b'\xaa\t\x08"\x00[/#\x00\xf1\x00\x87\xe9\xaa\t\x08"\x00[/#\x00\xf1\x00\x87\xe9'
b'\xaa\t\x08"\x00X/#\x00\xf1\x00\x87\xda\xaa\t\x08"\x00X/#\x00\xf1\x00\x87\xda'
b'\xaa\t\x08"\x00U/#\x00\xf1\x00\x86\xc7\xaa\t\x08"\x00U/#\x00\xf1\x00\x86\xc7'
b'\xaa\t\x08"\x00S/#\x00\xf1\x00\x86\xa1\xaa\t\x08"\x00S/#\x00\xf1\x00\x86\xa1'
b'\xaa\t\x08"\x00P/#\x00\xf1\x00\x86\x92\xaa\t\x08"\x00P/#\x00\xf1\x00\x86\x92'
b'\xaa\t\x08"\x00M/#\x00\xf1\x00\x85\x1f\xaa\t\x08"\x00M/#\x00\xf1\x00\x85\x1f'
b'\xaa\t\x08"\x00K/#\x00\xf1\x00\x85y\xaa\t\x08"\x00K/#\x00\xf1\x00\x85y'
b'\xaa\t\x08"\x00H/#\x00\xf1\x00\x85J\xaa\t\x08"\x00H/#\x00\xf1\x00\x85J'
b'\xaa\t\x08"\x00E/#\x00\xf1\x00\x84W\xaa\t\x08"\x00E/#\x00\xf1\x00\x84W''''